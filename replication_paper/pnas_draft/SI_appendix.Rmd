---
title: "Introducing ICBe: Supplementary Information Appendix"

# Use letters for affiliations, numbers to show equal authorship (if applicable) and to indicate the corresponding author
author:
  - name: Rex W. Douglass
    affiliation: a,1,2
  - name: Thomas Leo Scherer
    affiliation: a
  - name: J. Andrés Gannon
    affiliation: b
  - name: Erik Gartzke
    affiliation: a
  - name: Jon Lindsay
    affiliation: c
  - name: Shannon Carcelli
    affiliation: d
  - name: Jonathan Wilkenfeld
    affiliation: d
  - name: David M. Quinn
    affiliation: e
  - name: Catherine Aiken
    affiliation: f
  - name: Jose Miguel Cabezas Navarro
    affiliation: g
  - name: Neil Lund
    affiliation: d
  - name: Egle Murauskaite
    affiliation: h
  - name: Diana Partridge
    affiliation: h
    
address:
  - code: a
    address: Department of Political Science, University of California, San Diego, CA, USA.
  - code: b
    address: Belfer Center for Science and International Affairs, Harvard Kennedy School, MA, USA.
  - code: c
    address: School of Cybersecurity and Privacy | Sam Nunn School of International Affairs, Georgia Institute of Technology, GA, USA.
  - code: d
    address: Department of Government and Politics, University of Maryland, College Park, MD, USA.
  - code: e
    address: Faculty Specialist, National Consortium for the Study of Terrorism and Responses to Terrorism (START), University of Maryland, College Park, MD, USA.
  - code: f
    address: Edmund A. Walsh School of Foreign Service, Georgetown University, Washington, DC, USA.
  - code: g
    address: Society and Health Research Center, Universidad Mayor, Santiago, Chile.
  - code: h
    address: ICONS Project // START,  University of Maryland, College Park, MD, USA.
  - code: i
    address: ICONS Project // START,  University of Maryland, College Park, MD, USA.


corresponding_author:
  code: 2
  text: "To whom correspondence should be addressed. E-mail: rexdouglass@gmail.com"

# For footer text
lead_author_surname: Douglass

bibliography: ICBintro.bib
csl: pnas.csl

## change to true to add optional line numbering
lineno: false

output:
  pdf_document:
    toc: true
    toc_depth: 2

#Disabled several the caused errors
header-includes:
  - \usepackage[utf8]{inputenc}
  - \usepackage{pifont}
  - \usepackage{newunicodechar}
  - \newunicodechar{✓}{\ding{51}}
  - \newunicodechar{✗}{\ding{55}}
  - \usepackage{array}
  - \usepackage{ctable} # added for demo
  - \usepackage{natbib} #added for latex citation within huxtable
  - \usepackage{booktabs}
  - \usepackage{longtable}
  - \usepackage{array}
  - \usepackage{multirow}
  - \usepackage{wrapfig}
  - \usepackage{colortbl}
  - \usepackage{pdflscape}
  - \usepackage{tabu}
  - \usepackage{threeparttable}
  - \usepackage{threeparttablex}
  - \usepackage[normalem]{ulem}
  - \usepackage{makecell}
  - \usepackage{titlesec}
#  - \usepackage[parfill]{parskip}
  - \usepackage{makecell}
  - \usepackage{graphicx}
  - \usepackage{caption}
#  - \usepackage[capposition=top]{floatrow}
  - \titleformat{\subsubsection}{\normalfont\normalsize\itshape}{\thesubsubsection}{1em}{}
  - \titlespacing*{\subsubsection}{0pt}{3.25ex plus 1ex minus .2ex}{0ex plus .2ex}
  - \DeclareUnicodeCharacter{00A0}{ }
  - \usepackage{setspace}
  - \usepackage{cellspace}
  - \setlength\cellspacetoplimit{0.8ex}
  - \renewcommand{\arraystretch}{0.8}
  - \AtBeginEnvironment{tabular}{\singlespacing}
  - \AtBeginEnvironment{lltable}{\singlespacing}
#  - \usepackage[ruled,vlined,linesnumbered]{algorithm2e}
  - \usepackage{subcaption}
  - \usepackage{atbegshi}% http://ctan.org/pkg/atbegshi
  - \usepackage{float}
#  - \usepackage{eso-pic,graphicx,transparent}
#  - \usepackage[perpage]{footmisc}
  - \usepackage[algo2e]{algorithm2e}
  - \usepackage{algorithm}% http://ctan.org/pkg/algorithms
  - \usepackage{algpseudocode}% http://ctan.org/pkg/algorithmicx
#https://tex.stackexchange.com/questions/131646/algorithm2e-command-algorithm-already-defined
---


```{r, eval=T, echo=F, cache=F, results='hide', message=F}

knitr::opts_chunk$set(echo = TRUE)

#library(pacman)
library(googlesheets4)
library(tidyverse)
library(janitor)
library(flextable)
set_flextable_defaults(fonts_ignore=TRUE) #Warning: fonts used in `flextable` are ignored because the `pdflatex` engine is used and not `xelatex` or `lualatex`. You can avoid this warning by using the `set_flextable_defaults(fonts_ignore=TRUE)` command or use a compatible engine by defining `latex_engine: xelatex` in the YAML header of the R Markdown document.
library(ftExtra)
options(tidyverse.quiet = TRUE)
options(gargle_oauth_email = TRUE)

#install.packages('stargazer')
#install.packages('kableExtra')
#! sh: 1: pdflatex: not found
#sudo apt-get install texlive-latex-recommended texlive-fonts-recommended

#! LaTeX Error: File `letltxmacro.sty' not found.
#sudo apt-get install texlive-latex-extra

```

# SI Figures

## S1: Graphical User Interface {#app:gui}

\begin{figure}[H]
\caption{Graphical User Interface (GUI) for coding ICBe\label{fig:coding_gui}}
\centering{\includegraphics[width=17cm]{../figures/gui_example}}
\end{figure}

## S# : Algorithm 1 {#app:algo1}

\begin{algorithm}[H]
\SetAlgoLined
\KwData{Coder-Sentence-Tokens}
\KwResult{Sentence-Events}
\ForEach{sentence in sentences}{
  \ForEach{concept in concepts}{
    \ForEach{token in tokens}{
      \lIf{expert votes==0}{reject; \tcc*[f]{Require at least one expert vote}}
      \uElseIf{expert votes > expert voters/2}{accept; \tcc*[f]{And a majority of expert votes}}
      \uElseIf{undergrad votes > undergrad voters/2}{accept; \tcc*[f]{Or a majority of undergrad votes}}
    }
    \If{sum(accepted) == 0}{
      sort tags by votes;
      head 1;
      accept; \tcc*[f]{If still no tag, take one with most votes}
    }
  }
  \ForEach{ActorSet in unique(ActorSets)}{
    emit event;
  }
}
\caption{Aggregating Coder-Tokens into Sentence-Events}
\end{algorithm}

## S# : Intercoder Agreement {#app:intercoderagreement}

```{r, eval=T, echo=F, results='markup', include=T, message=F, cache=F, warning=F,  ft.arraystretch=0.75, fig.width=6, fig.height=6}
# #child=c('ICBEdataset_paper_PlotInterCoderAgreement.Rmd')
# 
# 
# # moved to ICBEdataset_paper_PlotInterCoderAgreement
# p_percent_chose_tag_by_concept <- readRDS(file=paste0(here::here(), '/paper/figures/p_percent_chose_tag_by_concept.Rds'))
# 
# ggplot2::ggsave(file=paste0(here::here(), '/paper/figures/p_percent_chose_tag_by_concept.png'), 
#                 plot = p_percent_chose_tag_by_concept, width=8, height=6)
# 
# # created in ICBEdataset_paper_PlotInterCoderAgreement.Rmd. Has \\label{fig:intercoderagreement}. 
```

<!-- moved to paper/figure/ICBEdataset_paper_PlotInterCoderAgreement -->

\begin{figure}[H]
\caption{Intercoder Agreement by Concept/Type \label{fig:intercoderagreement}}
\centering{\includegraphics[width=15cm]{../figures/p_percent_chose_tag_by_concept.png}}
\end{figure}



# SI Tables

## SI Table 1: ICB Crises and Summary Information {#app:crises}

```{r, eval=T, echo=F, results='markup', include=T, message=F, cache=F, warning=F,  ft.arraystretch=0.75}
#ICBEdataset_paper_appendixICBCrises.Rmd
crisis_text_counts_ft  <- readRDS(file=paste0(here::here(), '/replication_paper/tables/ft_crisis_text_counts.Rds'))
crisis_text_counts_ft
```


## Appendix 2: Verb Meanings (Glosses) found in the ICB Corpus (top 200) {#app:verbs}

```{r, eval=T, echo=F, results='markup', include=T, message=F, cache=F, warning=F,  ft.arraystretch=0.75}
#, child=c('ICBEdataset_paper_appendixVerbMeanings.Rmd')

verbs_sentence_wordnet_top_ft  <- readRDS(file=paste0(here::here(), '/replication_paper/tables/verbs_sentence_wordnet_top_ft.Rds'))
verbs_sentence_wordnet_top_ft
```


## Appendix 3: Sentence Examples {#app:50samplesentences}

```{r fiftysamplesentences, eval=T, echo=F, results='markup', include=T, message=F, cache=F, warning=F,  ft.arraystretch=1}
codings_wide_agreed_embeded_stratified_sample_ft <- readRDS(file=paste0(here::here(), '/replication_paper/tables/codings_wide_agreed_embeded_stratified_sample_ft.Rds')) %>%
  flextable::set_caption("ICBe Codings for 50 Sample Sentences") # \\label{tbl:fiftysamplesentences}

codings_wide_agreed_embeded_stratified_sample_ft %>%
      flextable::width( j = 1, width=0.3) %>%
      flextable::width( j = 2, width=3.5) %>%
      flextable::width( j = 3, width=3.5)
```


## Appendix 4: Cuban Missile Crisis {#app:ft_sentence_table_196}

```{r, eval=T, echo=F, results='markup', include=T, message=F, cache=F, warning=F,  ft.arraystretch=1}
ft_sentence_table_196 <- readRDS(file=paste0(here::here(), '/replication_paper/tables/sentence_tables/ft_sentence_table_196.Rds'))  %>%
  flextable::set_caption("ICBe Codings for Cuban Missile Crisis (Crisis 196)") # \\label{tbl:ft_sentence_table_196}
ft_sentence_table_196 %>%
      flextable::width( j = 1, width=0.3) %>%
      flextable::width( j = 2, width=3.25) %>%
      flextable::width( j = 3, width=3.25)
```



\begin{figure}[H]
\caption{Cuban Missile Crisis according to Phoenix \label{fig:196metromap_phoenix}}
\centering{\includegraphics[width=19cm]{../figures/p_phoenix_metro_plot_196.png}}
\end{figure}


\begin{figure}[H]
\caption{Cuban Missile Crisis according to ICB \label{fig:196metromap_icb}}
\centering{\includegraphics[width=19cm]{../figures/p_icb_metro_plot_196.png}}
\end{figure}

\begin{figure}[H]
\caption{Cuban Missile Crisis according to MIDs Episodes \label{fig:196metromap_mids}}
\centering{\includegraphics[width=19cm]{../figures/p_mids_metro_plot_196.png}}
\end{figure}


